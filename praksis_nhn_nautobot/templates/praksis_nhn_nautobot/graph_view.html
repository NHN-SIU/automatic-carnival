{% extends 'base.html' %} {% load static %} {% block content %}
<div class="row">
  <div class="col-md-12">
    <div class="panel panel-default">
      <div class="panel-heading">
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
          "
        >
          <h3 class="panel-title">Sambandshierarki for: {{ object }}</h3>
          <div class="btn-group" id="depth-controls">
            <span class="btn btn-default disabled">Dybde:</span>
            <a
              href="?depth=1"
              class="btn {% if depth == '1' %}btn-primary{% else %}btn-default{% endif %}"
              >1
            </a>
            <a
              href="?depth=2"
              class="btn {% if depth == '2' %}btn-primary{% else %}btn-default{% endif %}"
              >2
            </a>
            <a
              href="?depth=3"
              class="btn {% if depth == '3' %}btn-primary{% else %}btn-default{% endif %}"
              >3
            </a>
          </div>
        </div>
      </div>
      <div class="panel-body">
        <div
          id="connection-graph"
          style="
            height: 600px;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            margin-top: 10px;
          "
        ></div>
        <div class="panel-footer">
          <div class="legend">
            <span
              class="badge"
              style="background-color: #3498db; margin-right: 10px"
              >Samband</span
            >
            <span
              class="badge"
              style="background-color: #2ecc71; margin-right: 10px"
              >Forelder</span
            >
            <span
              class="badge"
              style="background-color: #e74c3c; margin-right: 10px"
              >Barn</span
            >
          </div>
        </div>
      </div>
    </div>
  </div>
  {% endblock %} {% block javascript %} {{ block.super }}
  <script src="https://d3js.org/d3.v6.min.js"></script>
  <script src="{% static '/js/graph_view.js' %}"></script>
  {{ depth|json_script:"depth" }}
  <script>
    // Pass data directly from Django context to JavaScript
    document.addEventListener("DOMContentLoaded", function () {
      let depth = JSON.parse(document.getElementById("depth").textContent);

      initGraphView({
        containerId: "connection-graph",
        connectionId: "{{ object.pk }}",
        depth: depth,
      });
    });
  </script>
  {% endblock %}
</div>
